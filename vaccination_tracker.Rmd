---
title: "Vaccination Tracker"
author: "Jens von Bergmann"
date: "Last updated at `r format(Sys.time(), '%d %B, %Y - %H:%M',tz='America/Vancouver')`"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	fig.retina = 2,
	dpi = 150,
	fig.width = 7,
	fig.height = 5
)
library(dplyr)
library(ggplot2)
library(CanCovidData)
library(cansim)
source(here("R/helpers.R"))

```

Vaccinations have arrived in Canada, and the [COVID-19 Tracker Canada](https://covid19tracker.ca) is collecting data on vaccinations. At this point we don't have good reporting standards of vaccinations and it is not clear how vaccination data will get reported.

The first round of vaccines Canada got is the mRNA vaccine from BioNTech that requires two doses, spaced 21 days apart, to be fully (~95%) effective, with the Moderna vaccine coming soon with similar requirements with the second dose administered after 28 days. Moreover, people are only considered vaccinated one week after having received the second vaccine. So it takes about a month from getting the first shot until a person is considered vaccinated.

## How to use the vaccine
There are two basic ways how local Health Authorities can utilize the vaccine. 

1. The first approach is to think of vaccines as an extra layer of protection and as saving lives. This approach would aim to keep current COVID-19 spread low irrespective of vaccines and see vaccines as an add-on until we reach acceptable levels of herd immunity. Herd immunity is generally pegged at around 70% of people immune to COVID-19, which translates to a similar share of the population being vaccinated. Herd immunity does not guarantee localized outbreaks though, especially given the overdispersed nature of COVID-19, so it will be important to have some level of distancing in place even past the herd immunity threshold. The goal of this approach is CovidZero, with vaccines protecting vulnerable populations, as well as helping to get to Zero via decreasing the pool of susceptible people.
2. The second approach would be to not focus on saving lives and morbidity but to keep these levels roughly constant and open up more instead.

The question of which approach to choose might seem like a question about values, but economists have been pretty clear that the evidence shows that reducing the spread of COVID-19 is the best way to open up the economy and that the second approach is misguided. In the background of all of this is the fact that it is not yet clear how robust the vaccine is in handling mutations, which again points toward the first approach being the only reasonable choice.

## Tracking vaccines
Glossing over reporting details, we can track how vaccines are aiding a CovidZero strategy (or how vaccines can help open up while keeping deaths and morbidities roughly constant if that's your jam).

```{r}
pop_data <- get_cansim("17-10-0005") %>%
  filter(REF_DATE==2020,`Age group`=="All ages",Sex=="Both sexes") %>%
  add_provincial_abbreviations() %>%
  select(Province=GEO,shortProvince=GEO.abb,Population=VALUE)

provinces <- c("BC",   "AB",   "SK",   "MB",   "ON" ,  "QC"  , "NB" ,  "PE" ,  "NS",   "NL")

vaccination_data <- provinces %>% 
  lapply(function(p) {
    get_can_covid_tracker_data(p) %>%
      mutate(shortProvince=p)
  }) %>%
  bind_rows() %>%
  left_join(pop_data,by="shortProvince") %>% 
  mutate_at("total_vaccinations",as.integer) %>% 
  select(Date,shortProvince,Province,total_vaccinations,Population) %>% 
  mutate(Share=total_vaccinations/Population)  %>%
  group_by(shortProvince) %>%
  arrange(Date)
```



```{r vaccination-status}
g <- vaccination_data %>%
  filter(total_vaccinations>0) %>%
  ggplot(aes(x=Date,y=Share)) +
  geom_bar(stat="identity",fill="purple") +
  facet_wrap("Province") +
  scale_y_continuous(labels=scales::percent) +
  theme_bw() +
  labs(title="COVID-19 vaccinations",y="Share of population who received the first dose",
       x=NULL,
       caption="MountainMath, Data: COVID-19 Tracker Canada")

r<-graph_to_s3(g,"bccovid","vaccination-status.png",width=knitr::opts_chunk$get('fig.width'),height=knitr::opts_chunk$get('fig.height'))
```
![](https://bccovid.s3.ca-central-1.amazonaws.com/vaccination-status.png)

If your goal is to use vaccinations to reduce deaths and morbidity, the share of the population who received vaccinations gives a rough indicator of the reduction a month from now when the vaccines take full effect. Since vaccinations are initially focused on vulnerable populations, the effect will be significantly higher than the shown percentage.

If your goal is to use vaccinations to keep deaths and morbidity roughly constant and instead open up faster, the share gives a rough indicator of by how much we can increase contacts a month from now when the vaccines take full effect. Again, because vaccinations are initially focused on vulnerable populations, we can probably increase contacts significantly more without increasing deaths, although this will likely have detrimental effects on morbidity. (If this sounds really cynical and like a terrible idea, that's probably because it is.)




